<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>simple_service_api - Documentation</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
            line-height: 1.6;
            color: #333;
        }
        .logo { text-align: center; margin-bottom: 2rem; }
        .logo img { max-width: 400px; }
        h1 { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 0.5rem; }
        h2 { color: #34495e; margin-top: 2rem; }
        code { background: #f4f4f4; padding: 0.2rem 0.4rem; border-radius: 3px; font-size: 0.9em; }
        pre { background: #f4f4f4; padding: 1rem; border-radius: 5px; overflow-x: auto; }
        pre code { background: none; padding: 0; }
        table { border-collapse: collapse; width: 100%; margin: 1rem 0; }
        th, td { border: 1px solid #ddd; padding: 0.75rem; text-align: left; }
        th { background: #f4f4f4; }
        a { color: #3498db; }
        .badge { display: inline-block; padding: 0.25rem 0.5rem; background: #27ae60; color: white; border-radius: 3px; font-size: 0.8em; }
    </style>
</head>
<body>
    <div class="logo">
        <img src="images/logo.png" alt="simple_ library logo">
    </div>

    <h1>simple_service_api</h1>
    <p><span class="badge">Service Layer</span></p>
    <p>Unified service layer facade for Eiffel web applications. Bundles authentication, email, database, CORS, rate limiting, templates, and WebSocket services.</p>

    <h2>Overview</h2>
    <p>The <code>SERVICE</code> class provides a single entry point to all web application services. It inherits from <code>FOUNDATION</code>, so you also get all core utilities (Base64, hashing, JSON, etc.).</p>

    <h2>Bundled Libraries</h2>
    <table>
        <tr><th>Library</th><th>Purpose</th></tr>
        <tr><td><a href="https://simple-eiffel.github.io/simple_jwt/">simple_jwt</a></td><td>JWT authentication</td></tr>
        <tr><td><a href="https://simple-eiffel.github.io/simple_smtp/">simple_smtp</a></td><td>Email sending</td></tr>
        <tr><td><a href="https://simple-eiffel.github.io/simple_sql/">simple_sql</a></td><td>SQLite database</td></tr>
        <tr><td><a href="https://simple-eiffel.github.io/simple_cors/">simple_cors</a></td><td>CORS handling</td></tr>
        <tr><td><a href="https://simple-eiffel.github.io/simple_rate_limiter/">simple_rate_limiter</a></td><td>Rate limiting</td></tr>
        <tr><td><a href="https://simple-eiffel.github.io/simple_template/">simple_template</a></td><td>Template rendering</td></tr>
        <tr><td><a href="https://simple-eiffel.github.io/simple_websocket/">simple_websocket</a></td><td>WebSocket protocol</td></tr>
        <tr><td><a href="https://simple-eiffel.github.io/simple_foundation_api/">simple_foundation_api</a></td><td>Core utilities (inherited)</td></tr>
    </table>

    <h2>Installation</h2>
    <pre><code>&lt;library name="simple_service_api"
        location="$SIMPLE_SERVICE_API\simple_service_api.ecf"/&gt;</code></pre>

    <h2>Quick Start</h2>
    <pre><code>local
    service: SERVICE
do
    create service.make

    -- JWT Authentication
    token := service.create_token ("secret", "user@example.com", "my-app", 3600)
    if service.verify_token ("secret", token) then
        print ("Token valid!%N")
    end

    -- Email
    smtp := service.new_smtp ("smtp.example.com", 587)

    -- Database
    db := service.new_memory_database
    db.execute ("CREATE TABLE users (id INTEGER PRIMARY KEY, name TEXT)")

    -- CORS
    cors := service.new_cors

    -- Rate Limiting
    limiter := service.new_rate_limiter (100, 60)

    -- Templates
    result := service.render_template ("Hello, {{name}}!", data)

    -- WebSocket
    frame := service.new_ws_text_frame ("Hello", True)

    -- Foundation utilities (inherited)
    encoded := service.base64_encode ("data")
    hash := service.sha256 ("password")
    uuid := service.new_uuid
end</code></pre>

    <h2>API Reference</h2>

    <h3>JWT Authentication</h3>
    <table>
        <tr><th>Feature</th><th>Description</th></tr>
        <tr><td><code>new_jwt (secret)</code></td><td>Create JWT handler</td></tr>
        <tr><td><code>create_token (secret, subject, issuer, expires)</code></td><td>Generate token</td></tr>
        <tr><td><code>verify_token (secret, token)</code></td><td>Verify token</td></tr>
    </table>

    <h3>SMTP Email</h3>
    <table>
        <tr><th>Feature</th><th>Description</th></tr>
        <tr><td><code>new_smtp (host, port)</code></td><td>Create SMTP client</td></tr>
    </table>

    <h3>SQL Database</h3>
    <table>
        <tr><th>Feature</th><th>Description</th></tr>
        <tr><td><code>new_database (path)</code></td><td>Open/create SQLite database</td></tr>
        <tr><td><code>new_memory_database</code></td><td>Create in-memory database</td></tr>
    </table>

    <h3>CORS</h3>
    <table>
        <tr><th>Feature</th><th>Description</th></tr>
        <tr><td><code>new_cors</code></td><td>Create CORS handler with defaults</td></tr>
        <tr><td><code>new_cors_permissive</code></td><td>Create permissive CORS handler</td></tr>
    </table>

    <h3>Rate Limiting</h3>
    <table>
        <tr><th>Feature</th><th>Description</th></tr>
        <tr><td><code>new_rate_limiter (max, window)</code></td><td>Create rate limiter</td></tr>
    </table>

    <h3>Templates</h3>
    <table>
        <tr><th>Feature</th><th>Description</th></tr>
        <tr><td><code>new_template</code></td><td>Create template engine</td></tr>
        <tr><td><code>render_template (template, data)</code></td><td>Render with substitutions</td></tr>
    </table>

    <h3>WebSocket</h3>
    <table>
        <tr><th>Feature</th><th>Description</th></tr>
        <tr><td><code>new_ws_handshake</code></td><td>Create handshake handler</td></tr>
        <tr><td><code>new_ws_frame_parser</code></td><td>Create frame parser</td></tr>
        <tr><td><code>new_ws_text_frame (text, is_final)</code></td><td>Create text frame</td></tr>
        <tr><td><code>new_ws_binary_frame (data, is_final)</code></td><td>Create binary frame</td></tr>
        <tr><td><code>new_ws_close_frame (code, reason)</code></td><td>Create close frame</td></tr>
        <tr><td><code>new_ws_ping_frame</code></td><td>Create ping frame</td></tr>
        <tr><td><code>new_ws_pong_frame</code></td><td>Create pong frame</td></tr>
    </table>

    <h3>Direct Access (Singleton Instances)</h3>
    <table>
        <tr><th>Feature</th><th>Description</th></tr>
        <tr><td><code>jwt</code></td><td>SIMPLE_JWT instance</td></tr>
        <tr><td><code>smtp</code></td><td>SIMPLE_SMTP instance</td></tr>
        <tr><td><code>cors</code></td><td>SIMPLE_CORS instance</td></tr>
        <tr><td><code>rate_limiter</code></td><td>SIMPLE_RATE_LIMITER instance</td></tr>
        <tr><td><code>template</code></td><td>SIMPLE_TEMPLATE instance</td></tr>
        <tr><td><code>websocket_handshake</code></td><td>WS_HANDSHAKE instance</td></tr>
        <tr><td><code>websocket_parser</code></td><td>WS_FRAME_PARSER instance</td></tr>
    </table>

    <h2>Architecture</h2>
    <pre>
┌─────────────────────────────────────────┐
│ simple_app_api (Application Layer)      │
└─────────────────┬───────────────────────┘
                  ▼
┌─────────────────────────────────────────┐
│ simple_service_api (Service Layer) ★    │
└─────────────────┬───────────────────────┘
                  ▼
┌─────────────────────────────────────────┐
│ simple_foundation_api (Foundation)      │
└─────────────────────────────────────────┘
    </pre>

    <h2>License</h2>
    <p>MIT License - Copyright (c) 2024-2025, Larry Rix</p>

    <hr>
    <p><a href="https://github.com/simple-eiffel/simple_service_api">GitHub Repository</a></p>
</body>
</html>
